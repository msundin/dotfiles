
#!/bin/bash

# List of applications to always close
apps_to_close=(
  # "Android Studio"
  "Microsoft Teams"
  # "Brave Browser"
  "Activity Monitor"
  "Microsoft Edge"
  # "Alacritty"
  # Add more applications here as needed
)

# List of applications that should never be closed
dont_close_lowercase=(
  # "finder"
  "systemuiserver"
  "dock"
  "alacritty"
  "brave"
  # Add more system applications here as needed
)

for app in "${apps_to_close[@]}"; do
  echo "Closing $app..."
  osascript -e "quit app \"$app\""
done

# Function to check if an app is in the dont_close list
should_close() {
  local app_name_lowercase=$(echo "$1" | awk '{print tolower($0)}')
  for dont_close in "${dont_close_lowercase[@]}"; do
    if [[ "$app_name_lowercase" == *"$dont_close"* ]]; then
      return 1
    fi
  done
  return 0
}

# Get the list of all running applications
running_apps=$(osascript -e 'tell application "System Events" to get name of (processes where background only is false)')

IFS=", " read -r -a running_apps_array <<< "$running_apps"

for app in "${running_apps_array[@]}"; do
  if should_close "$app"; then
    echo "Closing $app..."
    osascript -e "quit app \"$app\""
  else
    echo "Skipping $app..."
  fi
done
